"use strict";$(document).ready(function(){var isTouchScreen=!$("html").hasClass("no-touchscreen")&&!$("html").hasClass("desktop"),isIos=$("html").hasClass("ios"),isMobile=$("html").hasClass("mobile"),onEventType=isTouchScreen||isIos?"touchstart":"click",onFullTouchEventTypes=isTouchScreen||isIos?"touchstart touchmove touchend":"click",$header=$(".puzzle-new-header"),$searchPopup=$(".puzzle-new-header__global-search-popup"),searchButtonClass=".puzzle-new-header__global-search-icon-loupe_js_click",clearButtonClass=".puzzle-new-header__global-search-icon-clear_js_click",searchFormClass=".puzzle-new-header__global-search-form",$searchForm=$header.find(searchFormClass),$desktopInput=$searchForm.find(".is-header-global-search").find("input"),$mobileInput=$searchForm.find(".is-mobile-global-search").find("input"),headerToggleClass="is-global-search-open",isTouchMoved=false;function searchToggleHandle(target){$header.hasClass(headerToggleClass)?$header.removeClass(headerToggleClass):$header.addClass(headerToggleClass);isMobile?$mobileInput.focus():$desktopInput.focus()}$(document).on(onEventType,searchButtonClass,function(){searchToggleHandle($(this))});$(document).on(onEventType,clearButtonClass,function(){isMobile?$mobileInput.val("").focus():$desktopInput.val("").focus();$searchPopup.hide()});$(document).on(onFullTouchEventTypes,function(event){var target=event.target,isClickInForm=$(target).parents(searchFormClass).length||$(target).hasClass(searchFormClass);if(isClickInForm)return;switch(event.type){case"touchstart":isTouchMoved=false;break;case"touchmove":isTouchMoved=true;break;case"touchend":if(isTouchMoved)return;$header.hasClass("is-global-search-open")&&searchToggleHandle($(searchButtonClass));isTouchMoved=false;break;case"click":$header.hasClass("is-global-search-open")&&searchToggleHandle($(searchButtonClass))}$searchPopup.hide()});$(document).on("input","#global_search_term",function(e){var term=$("#global_search_term").val();if(term.length){$.ajax({url:window["HOME"],success:function(result){if(result.length){$(".puzzle-new-header__global-search-popup-item_container").html(result);$("#search_all_link").attr("href",encodeURI("/find?query="+term));$("#search_settings_link").attr("href",encodeURI("/find?query="+term+"#settings"));$searchPopup.show()}else{$searchPopup.hide()}},data:{ajax_action:"ajax_global_search",term:term},type:"post",dataType:"json"})}else{$searchPopup.hide()}});$(document).on("click",".global_search_add_word",function(e){var self=$(this);$.ajax({url:window["HOME"],data:{ajax_action:"ajax_dictionary_addWord",word:$(this).data("word"),translation:$(this).data("translation")},success:function(data){self.text("Добавлено");self.removeClass("puzzle-new-header__global-search-popup-item-btn");self.removeClass("border-link border-link_style_blue")}})})});